# ğŸ“Š Tá»•ng há»£p cÃ¡c Tá»‘i Æ°u hÃ³a - Collaborative Docs

## Má»¥c lá»¥c
1. [Tá»•ng quan há»‡ thá»‘ng](#1-tá»•ng-quan-há»‡-thá»‘ng)
2. [Danh sÃ¡ch tá»‘i Æ°u](#2-danh-sÃ¡ch-tá»‘i-Æ°u)
3. [Kiáº¿n trÃºc tá»•ng thá»ƒ](#3-kiáº¿n-trÃºc-tá»•ng-thá»ƒ)
4. [Káº¿t quáº£ Ä‘áº¡t Ä‘Æ°á»£c](#4-káº¿t-quáº£-Ä‘áº¡t-Ä‘Æ°á»£c)

---

## 1. Tá»•ng quan há»‡ thá»‘ng

**Collaborative Docs** lÃ  á»©ng dá»¥ng chá»‰nh sá»­a tÃ i liá»‡u real-time, há»— trá»£ nhiá»u ngÆ°á»i dÃ¹ng cÃ¹ng lÃ m viá»‡c trÃªn má»™t document.

### 1.1 Tech Stack

| Layer | Technology |
|-------|------------|
| **Frontend** | React + TypeScript + Tailwind CSS |
| **Backend** | Node.js + Express + Socket.IO |
| **Database** | MongoDB |
| **Cache** | Redis |
| **Container** | Docker + Docker Compose |

### 1.2 CÃ¡c bÃ¡o cÃ¡o chi tiáº¿t

| BÃ¡o cÃ¡o | MÃ´ táº£ | File |
|---------|-------|------|
| **Rate Limiting & Redis Cache** | Báº£o vá»‡ API vÃ  tá»‘i Æ°u cache | [rate-limit-redis-cache.md](./rate-limit-redis-cache.md) |
| **MongoDB Indexing** | Tá»‘i Æ°u truy váº¥n database | [mongodb-indexing-optimization.md](./mongodb-indexing-optimization.md) |
| **WebSocket Batching** | Giáº£m database writes | [websocket-batching-optimization.md](./websocket-batching-optimization.md) |
| **Redis Pub/Sub Scalability** | Multi-server support | [redis-pubsub-scalability.md](./redis-pubsub-scalability.md) |
| **Permission System** | Role-based access control | [permission-system-rbac.md](./permission-system-rbac.md) |
| **Dark Mode & Export** | UI features | [dark-mode-export-feature.md](./dark-mode-export-feature.md) |
| **Unit & Integration Testing** | Testing infrastructure | [unit-integration-testing.md](./unit-integration-testing.md) |

---

## 2. Danh sÃ¡ch tá»‘i Æ°u

### 2.1 Performance Optimizations

| Tá»‘i Æ°u | Váº¥n Ä‘á» | Giáº£i phÃ¡p | Cáº£i thiá»‡n |
|--------|--------|-----------|-----------|
| **WebSocket Batching** | QuÃ¡ nhiá»u DB writes khi typing | Buffer changes, ghi sau 2s | **94%** giáº£m writes |
| **Redis Document Cache** | Database load cao | Cache documents trong Redis | **90%** giáº£m latency |
| **MongoDB Indexing** | Slow queries | Index cÃ¡c trÆ°á»ng thÆ°á»ng query | **10-200x** faster |
| **Lean Queries** | Memory overhead | Sá»­ dá»¥ng `.lean()` cho queries | Giáº£m memory |

### 2.2 Security Optimizations

| Tá»‘i Æ°u | Váº¥n Ä‘á» | Giáº£i phÃ¡p | Cáº£i thiá»‡n |
|--------|--------|-----------|-----------|
| **HTTP Rate Limiting** | API spam/DDoS | Express rate limiter + Redis | Báº£o vá»‡ endpoints |
| **Socket Rate Limiting** | WebSocket flood | Custom middleware | Giá»›i háº¡n events |
| **Permission System** | Unauthorized access | Role-based access control | Granular permissions |

### 2.3 Scalability Optimizations

| Tá»‘i Æ°u | Váº¥n Ä‘á» | Giáº£i phÃ¡p | Cáº£i thiá»‡n |
|--------|--------|-----------|-----------|
| **Redis Pub/Sub** | Single server limit | Socket.IO Redis adapter | Horizontal scaling |
| **Graceful Fallback** | Redis downtime | In-memory fallback | High availability |
| **Stateless Servers** | Session affinity | Centralized state trong Redis | Load balancing |

### 2.4 Developer Experience

| Tá»‘i Æ°u | Váº¥n Ä‘á» | Giáº£i phÃ¡p | Cáº£i thiá»‡n |
|--------|--------|-----------|-----------|
| **Unit Tests** | Code reliability | Jest + ts-jest | 11 test cases |
| **Integration Tests** | API testing | Supertest | API coverage |
| **Docker Compose** | Dev environment | Multi-container setup | Easy deployment |

---

## 3. Kiáº¿n trÃºc tá»•ng thá»ƒ

### 3.1 System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              CLIENTS                                     â”‚
â”‚                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚ Browser  â”‚    â”‚ Browser  â”‚    â”‚ Browser  â”‚    â”‚ Browser  â”‚         â”‚
â”‚   â”‚ (User A) â”‚    â”‚ (User B) â”‚    â”‚ (User C) â”‚    â”‚ (User D) â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â”‚
â”‚        â”‚               â”‚               â”‚               â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚               â”‚               â”‚
         â”‚  HTTP/WS      â”‚  HTTP/WS      â”‚  HTTP/WS      â”‚  HTTP/WS
         â”‚               â”‚               â”‚               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        â”‚               â”‚               â”‚               â”‚                â”‚
â”‚        â–¼               â–¼               â–¼               â–¼                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                        LOAD BALANCER                             â”‚  â”‚
â”‚   â”‚                     (nginx / traefik)                            â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚                                       â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚              â”‚                  â”‚                  â”‚                   â”‚
â”‚              â–¼                  â–¼                  â–¼                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚   Server 1      â”‚ â”‚   Server 2      â”‚ â”‚   Server 3      â”‚         â”‚
â”‚   â”‚   (Node.js)     â”‚ â”‚   (Node.js)     â”‚ â”‚   (Node.js)     â”‚         â”‚
â”‚   â”‚                 â”‚ â”‚                 â”‚ â”‚                 â”‚         â”‚
â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚         â”‚
â”‚   â”‚ â”‚Rate Limiter â”‚ â”‚ â”‚ â”‚Rate Limiter â”‚ â”‚ â”‚ â”‚Rate Limiter â”‚ â”‚         â”‚
â”‚   â”‚ â”‚(Redis Store)â”‚ â”‚ â”‚ â”‚(Redis Store)â”‚ â”‚ â”‚ â”‚(Redis Store)â”‚ â”‚         â”‚
â”‚   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚         â”‚
â”‚   â”‚                 â”‚ â”‚                 â”‚ â”‚                 â”‚         â”‚
â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚         â”‚
â”‚   â”‚ â”‚  Socket.IO  â”‚ â”‚ â”‚ â”‚  Socket.IO  â”‚ â”‚ â”‚ â”‚  Socket.IO  â”‚ â”‚         â”‚
â”‚   â”‚ â”‚(Redis Adapt)â”‚ â”‚ â”‚ â”‚(Redis Adapt)â”‚ â”‚ â”‚ â”‚(Redis Adapt)â”‚ â”‚         â”‚
â”‚   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚         â”‚
â”‚   â”‚                 â”‚ â”‚                 â”‚ â”‚                 â”‚         â”‚
â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚         â”‚
â”‚   â”‚ â”‚  Batching   â”‚ â”‚ â”‚ â”‚  Batching   â”‚ â”‚ â”‚ â”‚  Batching   â”‚ â”‚         â”‚
â”‚   â”‚ â”‚  (Memory)   â”‚ â”‚ â”‚ â”‚  (Memory)   â”‚ â”‚ â”‚ â”‚  (Memory)   â”‚ â”‚         â”‚
â”‚   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚            â”‚                   â”‚                   â”‚                   â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                â”‚                                       â”‚
â”‚                                â–¼                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                          REDIS                                   â”‚  â”‚
â”‚   â”‚                                                                  â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚  â”‚
â”‚   â”‚  â”‚  Pub/Sub   â”‚  â”‚   Cache    â”‚  â”‚ Rate Limit â”‚                 â”‚  â”‚
â”‚   â”‚  â”‚  Channels  â”‚  â”‚  (doc:*)   â”‚  â”‚  Counters  â”‚                 â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                â”‚                                       â”‚
â”‚                                â–¼                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                        MONGODB                                   â”‚  â”‚
â”‚   â”‚                                                                  â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚   â”‚  â”‚                    documents collection                     â”‚ â”‚  â”‚
â”‚   â”‚  â”‚                                                            â”‚ â”‚  â”‚
â”‚   â”‚  â”‚  Indexes:                                                  â”‚ â”‚  â”‚
â”‚   â”‚  â”‚  - ownerId (single)                                        â”‚ â”‚  â”‚
â”‚   â”‚  â”‚  - name (single + text)                                    â”‚ â”‚  â”‚
â”‚   â”‚  â”‚  - createdAt (single)                                      â”‚ â”‚  â”‚
â”‚   â”‚  â”‚  - { ownerId, createdAt } (compound)                       â”‚ â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                        â”‚
â”‚                           INFRASTRUCTURE                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Request Flow

```
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚   HTTP Request    â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚  General Rate     â”‚
                                    â”‚  Limiter (100/min)â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚                   â”‚                   â”‚
                          â–¼                   â–¼                   â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚   /api/login    â”‚ â”‚ /api/documents  â”‚ â”‚   /health       â”‚
                 â”‚ Auth Limiter    â”‚ â”‚ Doc Limiter     â”‚ â”‚   (no limit)    â”‚
                 â”‚   (20/min)      â”‚ â”‚   (50/min)      â”‚ â”‚                 â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚                   â”‚
                           â–¼                   â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  Auth Routes    â”‚ â”‚ Document Routes â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 WebSocket Flow

```
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚ Socket Connection â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚  Connection Rate  â”‚
                                    â”‚  Limit (10/min)   â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚   Authenticate    â”‚
                                    â”‚   (userId check)  â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚                   â”‚                   â”‚
                          â–¼                   â–¼                   â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚  get-document   â”‚ â”‚  send-changes   â”‚ â”‚  save-document  â”‚
                 â”‚                 â”‚ â”‚  (30 events/sec)â”‚ â”‚  (30 events/sec)â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚                   â”‚                   â”‚
                           â–¼                   â–¼                   â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ Permission      â”‚ â”‚ Permission      â”‚ â”‚ Permission      â”‚
                 â”‚ Check           â”‚ â”‚ Check (canEdit) â”‚ â”‚ Check (canEdit) â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚                   â”‚                   â”‚
                           â–¼                   â–¼                   â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ Load from       â”‚ â”‚ Broadcast to    â”‚ â”‚ Batch & Save    â”‚
                 â”‚ Cache/DB        â”‚ â”‚ Room            â”‚ â”‚ (2s interval)   â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Káº¿t quáº£ Ä‘áº¡t Ä‘Æ°á»£c

### 4.1 Performance Metrics

| Metric | Before | After | Improvement |
|--------|--------|-------|-------------|
| Document Load (cached) | ~50ms | ~5ms | **90%** |
| DB Writes per minute (1 user typing) | ~500 | ~30 | **94%** |
| Query time (10k docs) | ~1000ms | ~20ms | **50x** |
| API Response (cached) | ~50ms | ~10ms | **80%** |

### 4.2 Scalability Metrics

| Metric | Single Server | Multi-Server |
|--------|---------------|--------------|
| Max concurrent users | ~1,000 | ~10,000+ |
| Horizontal scaling | âŒ | âœ… |
| High availability | âŒ | âœ… |

### 4.3 Security Metrics

| Threat | Protection |
|--------|------------|
| Brute Force Login | 20 req/min limit |
| API Spam | 100 req/min limit |
| WebSocket Flood | 10 conn/min, 50 events/sec |
| Unauthorized Access | Role-based permissions |

### 4.4 Code Quality

| Metric | Value |
|--------|-------|
| Unit Tests | 11 passed |
| Integration Tests | âœ… |
| TypeScript | Strict mode |
| Docker | Multi-stage builds |

---

## 5. Future Improvements

### 5.1 Potential Optimizations

| Improvement | Priority | Effort |
|-------------|----------|--------|
| WebSocket compression | Medium | Low |
| Redis Cluster | High | Medium |
| MongoDB Replica Set | High | Medium |
| CDN for static assets | Medium | Low |
| Operational Transformation (OT) | High | High |

### 5.2 Monitoring Additions

| Tool | Purpose |
|------|---------|
| Prometheus | Metrics collection |
| Grafana | Visualization |
| ELK Stack | Log aggregation |
| Sentry | Error tracking |

---

*Cáº­p nháº­t láº§n cuá»‘i: December 2025*
